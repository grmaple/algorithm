## 快速排序优化

### 快速选择算法

快速选择算法的基本思想是，当我们需要快速找到一个元素 X，并且使得小于 X 的元素数量是 k-1 个时，那 X 就是我们要查找的排名第 k 位的元素了。

partition 过程就是在每一轮排序中找到一个基准值元素的正确位置 ind ，并且它最厉害的地方在于，它会用基准值将数组分成前后两部分，小于等于基准值的元素在前面，大于等于基准值的元素在后面。

也就是说，经过一轮 partition 操作以后，我们总能将在当前数组中查找排名第 k 位元素的问题，转化成递归子问题。也就是在基准值的前面查找排名第 k 位的元素，或者在基准值的后面查找排名第 k - ind 位的元素。

快速选择算法的时间复杂度，最好情况是 O(n) ，最坏情况是 O(n^2) ，平均情况是 O(n) 。

### 快速排序优化

##### 优化一：单边递归优化

在快排函数的实现过程中，当本层完成了 partition 操作以后，剩余的工作就是等待着左边和右边的排序完成。

从程序的运行时间来考虑的话，我们每次函数调用，都会消耗掉一部分运行时间。那只要我们可以减少函数调用的次数，其实就可以加快一点程序运行的速度。

因此，单边递归优化的方式，就是当本层完成了 partition 操作以后，让本层继续完成基准值左边的 partition 操作，而基准值右边的排序工作交给下一层递归函数去处理。

##### 优化二：基准值选取优化

只有当基准值每次都能将排序区间中的数据平分时，时间复杂度才是最好情况下的 O(nlogn)。我们能不能尽可能地找到一个可以大概率将数组平分的数字呢？这就是关于基准值选取的一个优化策略，三点取中法。

所谓三点取中法，就是每一轮取排序区间的头、尾和中间元素这三个值，然后把它们排序以后的中间值作为本轮的基准值。

##### 优化三：partition 操作优化

partition 操作的目的，就是要把基准值位置后面的比基准值小的元素调整到前面，将基准值位置前面的比基准值大的元素调整到后面。既然需要调换的比基准值大的与比基准值小的元素的数量相同，我们就可以让头指针向后查找比基准值大的元素，尾指针向前查找比基准值小的元素，然后交换头尾指针所指向的元素，重复这个过程，直到头尾指针交错后停止。这就是对 partition 操作进行的优化。